<!DOCTYPE html>  <html> <head>   <title>zodiac.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="cosmos.html">                 cosmos.coffee               </a>                                           <a class="source" href="ensemble.html">                 ensemble.coffee               </a>                                           <a class="source" href="itemerge.html">                 itemerge.coffee               </a>                                           <a class="source" href="points.html">                 points.coffee               </a>                                           <a class="source" href="theres.html">                 theres.coffee               </a>                                           <a class="source" href="zodiac.html">                 zodiac.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               zodiac.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nv">_        = </span><span class="nx">require</span> <span class="s1">&#39;underscore&#39;</span>
<span class="nv">Backbone = </span><span class="nx">require</span> <span class="s1">&#39;backbone-rel&#39;</span>
<span class="nv">degrees  = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;upon&#39;</span><span class="p">).</span><span class="nx">degrees</span>
<span class="nv">polyglot = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;there&#39;</span><span class="p">).</span><span class="nx">polyglot</span>
<span class="nv">nestCollection = </span><span class="nx">require</span> <span class="s1">&#39;./nest-collection&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>It would be better if we don't have to instantite all the 360 portions
... and setup dispositor relations for each!</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Portion</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">RelationalModel</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Not sure if dispositors.coffee would be reintroduced...  For now, the
dispositors stuff scattered around.  Perhaps later it should be extracted
and mixed-in according to Cosmos preferences.
The various dispositor-fetching methods return a model from <code>Cosmos.ensemble</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">TrigonLords</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span>

  <span class="nv">initialize: </span><span class="nf">(@attributes, o) -&gt;</span>
    <span class="vi">@representation = </span><span class="nx">o</span><span class="p">.</span><span class="nx">representation</span>

  <span class="nv">dispositor: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">@representation</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">cosmos</span><span class="p">.</span><span class="nx">ensemble</span><span class="p">.</span><span class="nx">get</span> <span class="nx">id</span>

  <span class="nv">day: </span><span class="o">-&gt;</span>
    <span class="nx">@dispositor</span> <span class="p">(</span><span class="nx">@get</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">).</span><span class="nx">get</span> <span class="s1">&#39;lord&#39;</span><span class="p">)</span>

  <span class="nv">night: </span><span class="o">-&gt;</span>
    <span class="nx">@dispositor</span> <span class="p">(</span><span class="nx">@get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">).</span><span class="nx">get</span> <span class="s1">&#39;lord&#39;</span><span class="p">)</span>

  <span class="nv">cooperating: </span><span class="o">-&gt;</span>
    <span class="nx">@dispositor</span> <span class="p">(</span><span class="nx">@get</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">).</span><span class="nx">get</span> <span class="s1">&#39;lord&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nx">Confines</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span>

  <span class="nv">initialize: </span><span class="nf">(@attributes, o) -&gt;</span>
    <span class="vi">@representation = </span><span class="nx">o</span><span class="p">.</span><span class="nx">representation</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>EC is for Egyptian Confines, there are at least also PC for Ptolemy's.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@scheme = </span><span class="nx">o</span><span class="p">.</span><span class="nx">scheme</span> <span class="o">?</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span> <span class="nx">@attributes</span><span class="p">).</span><span class="nx">scheme</span> <span class="c1"># the first scheme</span>
    <span class="vi">@schemes = </span><span class="nx">_</span><span class="p">.</span><span class="nx">unique</span> <span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span> <span class="nx">@attributes</span><span class="p">,</span> <span class="s1">&#39;scheme&#39;</span> <span class="c1"># array of all the schemes</span>

  <span class="nv">dispositor: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">@representation</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">cosmos</span><span class="p">.</span><span class="nx">ensemble</span><span class="p">.</span><span class="nx">get</span> <span class="nx">id</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Get the confines dispositors of several (all possible) schemes.
Zodiac degrees array nicknamed <code>zodeg</code>.
TODO: change it back to degrees after the missing attributed bug is fixed.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">variants: </span><span class="nf">(zodeg, schemes = @schemes) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>TODO: this reprtesentation-relative further-more portion --
should probably be improved with mod('30').top() - which looks better...
mod is chainable degrees, instantiating new degrees
after taking the modulo.
TODO: furthermore, it is inappropriate to pass the representation number.
Just the relative degrees are needed.  The second parameter should come
from <code>@representation.get('idz')</code> - which attribute is currently missing!</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">portion = </span><span class="nx">degrees</span><span class="p">.</span><span class="nx">lon</span><span class="p">(</span><span class="nx">zodeg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">zodeg</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">rep</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nv">dispositors = </span><span class="p">{}</span>
    <span class="nv">results = </span><span class="nx">@filter</span> <span class="nf">(bounds) -&gt;</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">schemes</span><span class="p">,</span> <span class="nx">bounds</span><span class="p">.</span><span class="nx">get</span> <span class="s1">&#39;scheme&#39;</span><span class="p">)</span> <span class="o">and</span>
      <span class="nx">bounds</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nx">portion</span> <span class="o">and</span>
      <span class="nx">bounds</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;till&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nx">portion</span>
    <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">results</span>
      <span class="nx">dispositors</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">scheme</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@dispositor</span> <span class="nx">item</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">lord</span>
    <span class="nx">dispositors</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Get the confines dispositor of just one (preferred) scheme.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">followed: </span><span class="nf">(degrees, scheme = @scheme) -&gt;</span>
    <span class="p">(</span><span class="nx">@variants</span> <span class="nx">degrees</span><span class="p">,</span> <span class="p">[</span> <span class="nx">scheme</span> <span class="p">])[</span><span class="nx">scheme</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Cosmic / canonical representation (is no longer called sign, nor image)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Representation</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">RelationalModel</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Dispositor getters - named as simple (i.e. short) as descriptively possible.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">domicile: </span><span class="o">-&gt;</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="nx">cosmos</span><span class="p">.</span><span class="nx">ensemble</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">@get</span> <span class="s2">&quot;domicile&quot;</span><span class="p">)</span>

  <span class="nv">exaltation: </span><span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Signs without exaltation...  An <code>id</code> of <code>null</code> got with <code>getNone()</code>.
TODO: consider extending <code>Ensemble.get</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">@collection</span><span class="p">.</span><span class="nx">cosmos</span><span class="p">.</span><span class="nx">ensemble</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">@get</span> <span class="s2">&quot;exaltation&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="c1"># or N/A (on next line)</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="nx">cosmos</span><span class="p">.</span><span class="nx">ensemble</span><span class="p">.</span><span class="nx">getNone</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>TODO: each representation will have its 30 portions (nestedCollection)
which will point to a dispositor for monomoria and confines.
Decanic faces probably deserve their own (nested?) collection...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">initialize: </span><span class="nf">(attributes) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>The trigons attribute is tied to a <code>@trigons</code> nested collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">attributes</span><span class="p">.</span><span class="nx">trigons</span><span class="o">?</span>
      <span class="vi">@trigons = </span><span class="k">new</span> <span class="nx">TrigonLords</span> <span class="p">(</span><span class="nx">@get</span> <span class="s2">&quot;trigons&quot;</span><span class="p">),</span> <span class="nv">representation: </span><span class="err">@</span>
      <span class="nx">nestCollection</span> <span class="err">@</span><span class="p">,</span> <span class="s1">&#39;trigons&#39;</span><span class="p">,</span> <span class="nx">@trigons</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>The confines attribute is tied to a <code>@confines</code> nested collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">attributes</span><span class="p">.</span><span class="nx">confines</span><span class="o">?</span>
      <span class="vi">@confines = </span><span class="k">new</span> <span class="nx">Confines</span> <span class="p">(</span><span class="nx">@get</span> <span class="s2">&quot;confines&quot;</span><span class="p">),</span> <span class="nv">representation: </span><span class="err">@</span>
      <span class="nx">nestCollection</span> <span class="err">@</span><span class="p">,</span> <span class="s1">&#39;confines&#39;</span><span class="p">,</span> <span class="nx">@confines</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>The 12 representations (instances and their relations)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Zodiac</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span>

  <span class="nv">model: </span><span class="nx">Representation</span>

  <span class="nv">zoidia:</span>
    <span class="nv">the:</span>
      <span class="p">[</span> <span class="p">[</span> <span class="s1">&#39;PI&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;AR&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;TA&#39;</span> <span class="p">]</span>
      <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;GE&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;CN&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;LE&#39;</span> <span class="p">]</span>
      <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;VI&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;LI&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;SC&#39;</span> <span class="p">]</span>
      <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;SG&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;CP&#39;</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;AQ&#39;</span> <span class="p">]</span>
      <span class="p">]</span>
    <span class="nv">attributes:</span>
      <span class="nv">key: </span><span class="s2">&quot;id&quot;</span>
      <span class="nv">use:</span>
        <span class="nv">id: </span><span class="mi">0</span>
        <span class="nv">idz: </span><span class="mi">1</span> <span class="c1"># through initialize</span>
        <span class="nv">name: </span><span class="kc">null</span> <span class="c1"># polyglot&#39;s job</span>

  <span class="nv">words:</span>
    <span class="nv">expect: </span><span class="p">[</span> <span class="s2">&quot;name&quot;</span> <span class="p">]</span>
    <span class="nv">filler: </span><span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="nv">data:</span>
      <span class="s2">&quot;AR&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Ram&quot;</span><span class="p">,</span> <span class="s2">&quot;Aries&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Κριός&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Овен&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;TA&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Bull&quot;</span><span class="p">,</span> <span class="s2">&quot;Taurus&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Ταῦρος&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Телец&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;GE&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Twins&quot;</span><span class="p">,</span> <span class="s2">&quot;Gemini&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Δίδυμοι&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Близнаци&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;CN&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Crab&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancer&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Καρκίνος&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Рак&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;LE&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Lion&quot;</span><span class="p">,</span> <span class="s2">&quot;Leo&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Λέων&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Лъв&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;VI&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;Virgo&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Παρθένος&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Дева&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;LI&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Balance&quot;</span><span class="p">,</span> <span class="s2">&quot;Libra&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Ζυγός&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Везни&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;SC&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Scorpion&quot;</span><span class="p">,</span> <span class="s2">&quot;Scoprio&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Σκορπίος&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Скорпион&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;SG&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Archer&quot;</span><span class="p">,</span> <span class="s2">&quot;Sagittarius&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Τοξότης&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Стрелец&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;CP&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Goat-Horned&quot;</span><span class="p">,</span> <span class="s2">&quot;Capricorn&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Ἀιγόκερως&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Козирог&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;AQ&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Water-Pourer&quot;</span><span class="p">,</span> <span class="s2">&quot;Aquarius&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Φ̔δροχόος&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Водолей&quot;</span> <span class="p">]</span>
      <span class="s2">&quot;PI&quot;</span><span class="o">:</span>
        <span class="nv">name:</span>
          <span class="nv">en: </span><span class="p">[</span> <span class="s2">&quot;Fishes&quot;</span><span class="p">,</span> <span class="s2">&quot;Pisces&quot;</span> <span class="p">]</span>
          <span class="nv">el: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Ἰχθύες&quot;</span> <span class="p">]</span>
          <span class="nv">bg: </span><span class="p">[</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;Риби&quot;</span> <span class="p">]</span>

  <span class="nv">all: </span><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="mi">12</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Sometimes (only when testing?) <code>Zodiac</code> is instantiated without <code>@cosmos</code>.
The @language &amp; @school are optional - defaults set by <code>@translatable ()</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">initialize: </span><span class="nf">(models, @cosmos, attributes) -&gt;</span>
    <span class="k">if</span> <span class="nx">@cosmos</span><span class="o">?</span>
      <span class="vi">@school   = </span><span class="nx">@cosmos</span><span class="p">.</span><span class="nx">school</span>
      <span class="vi">@language = </span><span class="nx">@cosmos</span><span class="p">.</span><span class="nx">language</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="mi">11</span><span class="p">]</span>
      <span class="nx">@zoidia</span><span class="p">.</span><span class="nx">the</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">push</span> <span class="k">if</span> <span class="nx">i</span> <span class="o">is</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">12</span> <span class="k">else</span> <span class="nx">i</span>

    <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="err">@</span><span class="p">,</span> <span class="nx">polyglot</span><span class="p">.</span><span class="nx">ensure</span>
    <span class="nx">unless</span> <span class="nx">@translatable</span> <span class="p">[</span> <span class="nx">@zoidia</span> <span class="p">]</span> <span class="k">then</span> <span class="k">throw</span> <span class="s2">&quot;The zoidia can&#39;t be named!&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Note: this could be extracted to a helper for reuse when resetting.
It only reorders the attributes.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">z = </span><span class="p">[]</span> <span class="c1"># zoidia</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span> <span class="p">..</span> <span class="nx">@zoidia</span><span class="p">.</span><span class="nx">the</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
      <span class="nx">z</span><span class="p">.</span><span class="nx">push</span> <span class="p">{}</span>
      <span class="k">for</span> <span class="nx">attribute</span><span class="p">,</span> <span class="nx">position</span> <span class="k">of</span> <span class="nx">@zoidia</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">use</span>
        <span class="nx">z</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@zoidia</span><span class="p">.</span><span class="nx">the</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">position</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Additional attributes are passed in by the Cosmos builder.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="nx">z</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">attributes</span><span class="o">?</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
    <span class="nx">@reset</span> <span class="nx">z</span>

    <span class="err">@</span> <span class="c1"># chainable</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Relies on the <code>@models</code> order not to change.  In this sense,
it's a kind of <em>hack</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">id: </span><span class="nf">(idz) -&gt;</span>
    <span class="nx">@at</span> <span class="k">if</span> <span class="nx">idz</span> <span class="o">is</span> <span class="mi">12</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="nx">idz</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Question: wouldn't it be better to implement @ids ...
and based on a filtered subset of the collection, pluck the 'name' of each?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">names: </span><span class="nf">(which = @all) -&gt;</span>
    <span class="nv">which = </span><span class="p">[</span><span class="nx">which</span><span class="p">]</span> <span class="nx">unless</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span> <span class="nx">which</span>

    <span class="nv">names = </span><span class="p">[]</span>
    <span class="k">for</span> <span class="nx">idz</span> <span class="k">in</span> <span class="nx">which</span>
      <span class="nx">names</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@id</span><span class="p">(</span><span class="nx">idz</span><span class="p">).</span><span class="nx">get</span> <span class="s1">&#39;name&#39;</span>
    <span class="nx">names</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Take some or @all idz numbers + iterator function to filter them with.
This is mostly for DRY @male &amp; @female (odd / even) checks.
Note if male &amp; female become initialized to "gender" attribute,
we could perhaps skip adding (the redundant) idz to <code>@zoidia.attributes.use</code>
and instead <code>_.pluck @zoidia.the, "idz"</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">idzF: </span><span class="nf">(idz = @all, iterator) -&gt;</span>
    <span class="nv">idz = </span><span class="p">[</span><span class="nx">idz</span><span class="p">]</span> <span class="nx">unless</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span> <span class="nx">idz</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Kind-of sorts the collection by idz.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_</span><span class="p">.</span><span class="nx">intersection</span> <span class="nx">idz</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span> <span class="p">(</span><span class="nx">@pluck</span> <span class="s1">&#39;idz&#39;</span><span class="p">),</span> <span class="nx">iterator</span>

  <span class="nv">female: </span><span class="nf">(idz) -&gt;</span>
    <span class="nx">@idzF</span> <span class="nx">idz</span><span class="p">,</span> <span class="nf">(z) -&gt;</span> <span class="nx">z</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">is</span> <span class="mi">0</span>

  <span class="nv">male: </span><span class="nf">(idz) -&gt;</span>
    <span class="nx">@idzF</span> <span class="nx">idz</span><span class="p">,</span> <span class="nf">(z) -&gt;</span> <span class="nx">z</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">is</span> <span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>A combined report of all the possible confines,
or else of specified schemes,
given a list (i.e. array) of [representation, portion] arrays.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">confines: </span><span class="nf">(list, schemes) -&gt;</span>
    <span class="nv">results = </span><span class="p">[]</span>
    <span class="k">for</span> <span class="nx">c</span> <span class="k">in</span> <span class="nx">list</span>
      <span class="nv">several = </span><span class="p">{}</span>
      <span class="nv">previous = </span><span class="kc">undefined</span>
      <span class="nv">where = </span><span class="s2">&quot;#{c[0]},#{c[1]}&quot;</span>
      <span class="nx">several</span><span class="p">[</span><span class="nx">where</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
      <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">@id</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">confines</span><span class="p">.</span><span class="nx">variants</span> <span class="p">[</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="nv">name = </span><span class="nx">value</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">name</span>
        <span class="k">if</span> <span class="nx">name</span> <span class="o">isnt</span> <span class="nx">previous</span>
          <span class="nx">several</span><span class="p">[</span><span class="nx">where</span><span class="p">][</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">key</span><span class="p">]</span>
        <span class="k">else</span>
          <span class="nx">several</span><span class="p">[</span><span class="nx">where</span><span class="p">][</span><span class="nx">name</span><span class="p">].</span><span class="nx">push</span> <span class="nx">key</span>
        <span class="nv">previous = </span><span class="nx">name</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">push</span> <span class="nx">several</span>
    <span class="nx">results</span>


<span class="nv">module.exports = </span><span class="nx">Zodiac</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 